from pymongo import MongoClient
from pymongo.errors import ConnectionFailure
from bson.json_util import loads
from datetime import datetime

user = ""
password = ""
dbname = ""
host = ""
port = 27017
addresses = [(host, port)]

try:
    client = MongoClient(addresses, username=user, password=password, authSource=dbname)
    db = client[dbname]
    collection = db[""]
    filePath = ""
    with open(filePath, "rb") as jsonFile:
        jsonData = jsonFile.read()
        doc = loads(jsonData)
        startTime = datetime.now()
        result = collection.insert_one(doc)
        endTime = datetime.now()
        timeTaken = (endTime - startTime).total_seconds() * 1000
        bytesPerMillisecond = len(jsonData) / timeTaken
        print("Bytes per millisecond:", bytesPerMillisecond)
        print("Time taken:", timeTaken)
except ConnectionFailure as e:
    print("Could not connect to server:", e)
except Exception as ex:
    print("Error:", ex)
