SELECT 
    etf.SECURITYID, 
    etf.ASATDATE, 
    SUM(etf_positions.POSITION) AS POSITION, 
    SUM(etf_basket_postions.AMOUNT) AS AMOUNT, 
    GROUP_CONCAT(etf_constituents.CONSTITUENTID) AS CONSTITUENTIDS
FROM MIDAS.TBL_ETF AS etf 
LEFT JOIN MIDAS.TBL_ETFPOSITIONS AS etf_positions ON etf.SECURITYID=etf_positions.SECURITYID AND etf.ASATDATE=etf_positions.ASATDATE
LEFT JOIN MIDAS.TBL_ETFBASKETPOSITIONS AS etf_basket_postions ON etf.SECURITYID=etf_basket_postions.SECURITYID AND etf.ASATDATE=etf_basket_postions.ASATDATE
LEFT JOIN MIDAS.TBL_ETFCONSTITUENTS AS etf_constituents ON etf.SECURITYID=etf_constituents.SECURITYID AND etf.ASATDATE=etf_constituents.ASATDATE
WHERE etf.SECURITYID='745749' AND etf.ASATDATE='2023-04-12'
GROUP BY etf.SECURITYID, etf.ASATDATE;
